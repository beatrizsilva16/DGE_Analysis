---
title: "DGE_Chronic_Experiment"
author: "Beatriz Silva"
date: "2023-10-26"
output: pdf_document
---

## Loading libraries

```{r}

library(edgeR)
library(limma)
library(DESeq2)
library(dplyr)
library(pheatmap)
library(ggplot2)
library(gplots)
library(grid)

```

## Read files

```{r}

setwd("C:/Users/USUARIO/Desktop/Ude_analysis/Gene_expression/DGE_Chronic_Experiments/DGE_Analysis")


data_counts <- read.table("countData_with_N20G4.txt", header = TRUE, sep = "\t", row.names = 1, check.names = FALSE)
sample_info <- read.table("colData_with_N20G4.txt", header = TRUE, sep = "\t", row.names = 1, check.names = FALSE)

group <- factor(paste(sample_info$pop, sample_info$temperature, sep="."))
sample_info <- cbind(sample_info, group = group)

# DGEList object

y <- DGEList(counts = data_counts, group = group)

cpm_count <- cpm(y)
  
# thresholds

cpm_Val <- 1   # CPM value threshold
gThreshold <- 5   # At least number of samples threshold

thresholds <- rowSums(cpm_count > cpm_Val) >= gThreshold

y <- calcNormFactors(y, lib.size = T, method = "TMM")

# Apply filtering

y_filter <- y[thresholds,]

# Get CPM values for filtered data (y_filter)

cpm_count_filtered <- cpm(y_filter)

dim(cpm_count_filtered) # [1] 22696    30


```

## Boxplot with sample distribution

```{r}

# Normalized Samples Distribution - Chronic

statuscol <- as.numeric(factor(sample_info$group)) + 1
log_counts <- log(cpm_count_filtered + 1e-02) 

boxplot(log_counts,
        col = statuscol,
        xlab = "", las = 2,
        cex.axis = 0.8, 
        outline = FALSE)
abline(h = median(as.matrix(log_counts)), col = "blue")
title("Normalized Samples Distribution", cex.main = 0.9)
 

```

## MDS plot

```{r}

# MDS plot 

library(ggplot2)

dist_matrix <- 1 - cor(cpm_count_filtered)
mds_result <- cmdscale(dist_matrix, k = 2)
mds_df <- data.frame(Sample = rownames(mds_result), Dim1 = mds_result[, 1], Dim2 = mds_result[, 2])

ggplot(mds_df, aes(x = Dim1, y = Dim2, color = group, label = Sample)) +
  geom_point() +
  geom_text(vjust = -0.5, hjust = 0.5, size = 3) +  
  scale_color_discrete(guide = guide_legend(title = "Groups")) +
  labs(title = "MDS Plot") +
  theme(legend.position = "left", 
        legend.justification = "center",
        plot.title = element_text(hjust = 0.5),
        legend.text = element_text(angle = 0)) +  
  ggtitle("MDS Plot")

```

## Read files without N20G4

```{r}

data_counts <- read.table("countData_wihout_N20G4.txt", header = TRUE, sep = "\t", row.names = 1, check.names = FALSE)
sample_info <- read.table("colData_without_N20G4.txt", header = TRUE, sep = "\t", row.names = 1, check.names = FALSE)

group <- factor(paste(sample_info$pop, sample_info$temperature, sep = "."))

sample_info <- cbind(sample_info, group = group)


# Create DGEList object

y <- DGEList(counts = data_counts, group = group)

# Calculate CPM

cpm_count <- cpm(y)

# Set thresholds

cpm_Val <- 1   # CPM value threshold
gThreshold <- 4   # At least number of samples threshold

thresholds <- rowSums(cpm_count > cpm_Val) >= gThreshold

y <- calcNormFactors(y, lib.size = T, method = "TMM")

y_filter <- y[thresholds,]

# Get CPM values for filtered data (y_filter)

cpm_count_filtered_final <- cpm(y_filter)

dim(cpm_count_filtered_final) # [1] 23202    29
head(cpm_count_filtered_final)

```

## Boxplot with sample distribution without N20G4

```{r}

# Normalized Samples Distribution - Chronic without sample N20G4

statuscol <- as.numeric(factor(sample_info$group)) + 1
log_counts <- log(cpm_count_filtered_final + 1e-02) 

boxplot(log_counts,
        col = statuscol,
        xlab = "", las = 2,
        cex.axis = 0.8, 
        outline = FALSE)
abline(h = median(as.matrix(log_counts)), col = "blue")
title("Normalized Samples Distribution without sample N20G4", cex.main = 0.9)
 
```

## MDS Plot without N20G4

```{r}

# MDS plot without the sample N20G4

dist_matrix <- 1 - cor(cpm_count_filtered_final)
mds_result <- cmdscale(dist_matrix, k = 2)
mds_df <- data.frame(Sample = rownames(mds_result), Dim1 = mds_result[, 1], Dim2 = mds_result[, 2])

ggplot(mds_df, aes(x = Dim1, y = Dim2, color = group, label = Sample)) +
  geom_point() +
  geom_text(vjust = -0.5, hjust = 0.5, size = 3) +  
  scale_color_discrete(guide = guide_legend(title = "Groups")) +
  labs(title = "MDS Plot") +
  theme(legend.position = "left", 
        legend.justification = "center",
        plot.title = element_text(hjust = 0.5),
        legend.text = element_text(angle = 0)) +  
  ggtitle("MDS Plot")

```

## EdgeR

```{r}


# Design matrix for glm approach

design <- model.matrix(~0 + group)

colnames(design) <- levels(group)

yf <- estimateDisp(y_filter, design)

fit <- glmFit(yf, design)

################  Contrasts all conditions  ################

contrasts <- makeContrasts(
         S20_S25 = S.20-S.25,
         S20_S30 = S.20-S.30,
         S25_S30 = S.25-S.30,
         N20_N25 = N.20-N.25,
         N20_N30 = N.20-N.30,
         N25_N30 = N.25-N.30,
         N20_S20 = N.20-S.20,
         N25_S25 = N.25-S.25,
         N30_S30 = N.30-S.30,
         levels = colnames(coef(fit))
)

################ Contrasts - South Population ################

contrasts_south <- makeContrasts(
  S20_S25 = S.20 - S.25,
  S20_S30 = S.20 - S.30,
  levels = design
)

################ Contrasts - North Population ################

contrasts_north <- makeContrasts(
  N20_N25 = N.20 - N.25,
  N20_N30 = N.20 - N.30,
  levels = design
)

```

## Dispersion Plot - EdgeR

```{r}

plotBCV(yf)

```

# EdgeR - North 20 ºC vs South 20 ºC

```{r}
qlf_north_south_20 <- glmLRT(fit, contrast = contrasts[,"N20_S20"])

FDR_north_south_20 <- topTags(qlf_north_south_20, n = Inf, adjust.method = "BH", sort.by = "none")
FDR_north_south_df_20 <- data.frame(gene_id = rownames(FDR_north_south_20), FDR_north_south_20)
filtered_rows_north_south_20 <- FDR_north_south_df_20[FDR_north_south_df_20$FDR < 0.05 & abs(FDR_north_south_df_20$logFC) > 1, ]
DGEs_EdgeR_north_south_20 <- filtered_rows_north_south_20[, c("gene_id", "logFC", "FDR")]

dim(DGEs_EdgeR_north_south_20) # [1] 583   6

```

```{r}

output_data_20 <- cpm_count_filtered_final[, grepl("^N20|^S20", colnames(cpm_count_filtered_final))]

# Add the 'gene_id' column to the output_data matrix
data_gene_id_20 <- cbind(gene_id = rownames(output_data_20), output_data_20)

# Add the name of the first column: gene_id
names(data_gene_id_20) <- c("gene_id", names(data_gene_id_20)[-1])

# merge the data frames based on the "gene_id" column
merged_df_20 <- merge(data_gene_id_20, DGEs_EdgeR_north_south_20[, c("gene_id", "logFC", "FDR")], by = "gene_id")

# Selecting the desired columns
final_table_20 <- merged_df_20[, c("gene_id", "N20G1", "N20G2", "N20G3", "N20G5", "S20G1", "S20G2", "S20G3", "S20G4", "S20G5")]

# Convert character matrix to numeric matrix element-wise
numeric_matrix_20 <- final_table_20[, c("N20G1", "N20G2", "N20G3", "N20G5", "S20G1", "S20G2", "S20G3", "S20G4", "S20G5")]
numeric_matrix_20 <- apply(numeric_matrix_20, 2, as.numeric)  # Convert each column to numeric

# Set row names
rownames(numeric_matrix_20) <- final_table_20$gene_id

# Set column names
colnames(numeric_matrix_20) <- c("N20G1", "N20G2", "N20G3", "N20G5", "S20G1", "S20G2", "S20G3", "S20G4", "S20G5")

head(numeric_matrix_20)
dim(numeric_matrix_20)

```

# EdgeR - North 25 ºC vs South 25 ºC

```{r}


qlf_north_south_25 <- glmLRT(fit, contrast = contrasts[,"N25_S25"])
FDR_north_south_25 <- topTags(qlf_north_south_25, n = Inf, adjust.method = "BH", sort.by = "none")
FDR_north_south_df_25 <- data.frame(gene_id = rownames(FDR_north_south_25), FDR_north_south_25)
filtered_rows_north_south_25 <- FDR_north_south_df_25[FDR_north_south_df_25$FDR < 0.05 & abs(FDR_north_south_df_25$logFC) > 1, ]
DGEs_EdgeR_north_south_25 <- filtered_rows_north_south_25[, c("gene_id", "logFC", "FDR")]

dim(DGEs_EdgeR_north_south_25) # [1] 1527    6

```

# EdgeR - North 30 ºC vs South 30 ºC

```{r}


qlf_north_south_30 <- glmLRT(fit, contrast = contrasts[,"N30_S30"])
FDR_north_south_30 <- topTags(qlf_north_south_30, n = Inf, adjust.method = "BH", sort.by = "none")
FDR_north_south_df_30 <- data.frame(gene_id = rownames(FDR_north_south_30), FDR_north_south_30)
filtered_rows_north_south_30 <- FDR_north_south_df_30[FDR_north_south_df_30$FDR < 0.05 & abs(FDR_north_south_df_30$logFC) > 1, ]
DGEs_EdgeR_north_south_30 <- filtered_rows_north_south_30[, c("gene_id", "logFC", "FDR")]

dim(DGEs_EdgeR_north_south_30) # [1] 2853    6

```

# EdgeR - North 20 ºC vs 25 ºC vs 30 ºC

```{r}

qlf_north <- glmLRT(fit, contrast = contrasts_north)
FDR_north <- topTags(qlf_north, n = Inf, adjust.method = "BH", sort.by = "none")
FDR_north_df <- data.frame(gene_id = rownames(FDR_north), FDR_north)
filtered_rows_north <- FDR_north_df[FDR_north_df$FDR < 0.05 & abs(FDR_north_df$logFC.N20_N25) > 1 & abs(FDR_north_df$logFC.N20_N30) > 1, ]

filtered_rows_north <- filtered_rows_north[, c("gene_id", "logFC.N20_N25", "logFC.N20_N30")]

filtered_rows_north <- filtered_rows_north[, -1]

# Create a data frame with the "gene_id" column containing the row names and the "South_20" column filled with zeros
DGEs_EdgeR_north_20_25_30 <- data.frame(gene_id = rownames(filtered_rows_north), North_20 = 0, filtered_rows_north)

dim(DGEs_EdgeR_north_20_25_30) # [1] 75  4


```

# EdgeR - South 20 ºC vs 25 ºC vs 30 ºC

```{r}

qlf_south <- glmLRT(fit, contrast = contrasts_south)
FDR_south <- topTags(qlf_south, n = Inf, adjust.method = "BH", sort.by = "none")
FDR_south_df <- data.frame(gene_id = rownames(FDR_south), FDR_south)
filtered_rows_south <- FDR_south_df[FDR_south_df$FDR < 0.05 & abs(FDR_south_df$logFC.S20_S25) > 1 & abs(FDR_south_df$logFC.S20_S30) > 1, ]

filtered_rows_south <- filtered_rows_south[, c("gene_id", "logFC.S20_S25", "logFC.S20_S30")]

filtered_rows_south <- filtered_rows_south[, -1]

# Create a data frame with the "gene_id" column containing the row names and the "South_20" column filled with zeros
DGEs_EdgeR_south_20_25_30 <- data.frame(gene_id = rownames(filtered_rows_south), South_20 = 0, filtered_rows_south)

dim(DGEs_EdgeR_south_20_25_30)  # [1] 534   4

```

# EdgeR - North vs South

```{r}

# Design matrix for glm approach

design <- model.matrix(~sample_info$pop + sample_info$temperature)
rownames(design) <- colnames(y_filter)
yf <- estimateDisp(y_filter, design)
fit <- glmFit(yf, design)

glm <- glmLRT(fit, coef=2)

FDR_chronic_all <- topTags(glm, n = Inf, adjust.method = "BH", sort.by = "none")
FDR_chronic_all <- data.frame(gene_id = rownames(FDR_chronic_all), FDR_chronic_all)
filtered_rows_chronic_all <- FDR_chronic_all[FDR_chronic_all$FDR < 0.05 & abs(FDR_chronic_all$logFC) > 1, ]
DGEs_EdgeR_North_South <- filtered_rows_chronic_all[, c("gene_id", "logFC", "FDR")]

dim(DGEs_EdgeR_North_South) #   [1] 2891    3

```

# limma

```{r}

# design matrix - voom transformation

design <- model.matrix(~0+group)

colnames(design) <- levels(group)

yf <- voom(y_filter, design, normalize="quantile", plot=T)


# Fitting linear models in limma

fit <- lmFit(yf, design)


################  Contrasts all  ################

contrasts <- makeContrasts(
         S20_S25 = S.25-S.20,
         S20_S30 = S.30-S.20,
         S25_S30 = S.30-S.25,
         N20_N25 = N.25-N.20,
         N20_N30 = N.30-N.20,
         N25_N30 = N.30-N.25,
         N20_S20 = S.20-N.20,
         N25_S25 = S.25-N.25,
         N30_S30 = S.30-N.30,
         levels = colnames(coef(fit))
)


################  Contrasts  South Population  ################

contrasts_south <- makeContrasts(
          S20_S25 = S.25-S.20,
          S20_S30 = S.30-S.20,
          levels=design
)


################  Contrasts  North Population  ################

contrasts_north <- makeContrasts(
          N20_N25 = N.25-N.20,
          N20_N30 = N.30-N.20,
          levels=design
)


tmp <- contrasts.fit(fit, contrasts)
tmp_f <- eBayes(tmp)

## Contrasts - South all

tmp_south <- contrasts.fit(fit, contrasts_south)
tmp_south_f <- eBayes(tmp_south)

## Contrasts - North all

tmp_north <- contrasts.fit(fit, contrasts_north)
tmp_north_f <- eBayes(tmp_north)


```

# limma - North 20 ºC vs South 20 ºC

```{r}


tmp_North_South_20 <- contrasts.fit(fit, contrasts[,"N20_S20"])
tmp_North_South_20_f <- eBayes(tmp_North_South_20)

top.table_North_South_20 <- topTable(tmp_North_South_20_f, number=Inf, adjust="BH", sort.by="none")
FDR_North_South_df_20 <- data.frame(gene_id = rownames(top.table_North_South_20), top.table_North_South_20)
filtered_North_South_20 <- FDR_North_South_df_20[FDR_North_South_df_20$adj.P.Val < 0.05 & abs(FDR_North_South_df_20$logFC) > 1, ]
DGEs_Limma_north_south_20 <- filtered_North_South_20[, c("gene_id", "logFC", "adj.P.Val")]

dim(DGEs_Limma_north_south_20) # [1] 169    7

```

# limma - North 25 ºC vs South 25 ºC

```{r}


# thresholds North 25 vs South 25

tmp_North_South_25 <- contrasts.fit(fit, contrasts[,"N25_S25"])
tmp_North_South_25_f <- eBayes(tmp_North_South_25)

top.table_North_South_25 <- topTable(tmp_North_South_25_f, number=Inf, adjust="BH", sort.by="none")
FDR_North_South_df_25 <- data.frame(gene_id = rownames(top.table_North_South_25), top.table_North_South_25)
filtered_North_South_25 <- FDR_North_South_df_25[FDR_North_South_df_25$adj.P.Val < 0.05 & abs(FDR_North_South_df_25$logFC) > 1, ]
DGEs_Limma_north_south_25 <- filtered_North_South_25[, c("gene_id", "logFC", "adj.P.Val")]

dim(DGEs_Limma_north_south_25) # [1] 718    7

```

# limma - North 30 ºC vs South 30 ºC

```{r}

# thresholds North 30 vs South 30

tmp_North_South_30 <- contrasts.fit(fit, contrasts[,"N30_S30"])
tmp_North_South_30_f <- eBayes(tmp_North_South_30)

top.table_North_South_30 <- topTable(tmp_North_South_30_f, number=Inf, adjust="BH", sort.by="none")
FDR_North_South_df_30 <- data.frame(gene_id = rownames(top.table_North_South_30), top.table_North_South_30)
filtered_North_South_30 <- FDR_North_South_df_30[FDR_North_South_df_30$adj.P.Val < 0.05 & abs(FDR_North_South_df_30$logFC) > 1, ]
DGEs_Limma_north_south_30 <- filtered_North_South_30[, c("gene_id", "logFC", "adj.P.Val")]

dim(DGEs_Limma_north_south_30) # [1]  2090    7
```

# limma - North 20 ºC vs 25 ºC vs 30 ºC

```{r}


top.table_north <- topTable(tmp_north_f, number=Inf, adjust="BH", sort.by="none")

FDR_north_df <- data.frame(rowname = rownames(top.table_north), top.table_north)

# Filter the selected rows
selected_rows <- top.table_north[top.table_north$adj.P.Val < 0.05 & abs(top.table_north$N20_N25) > 1 & abs(top.table_north$N20_N30) > 1, ]

# Create a data frame with the desired columns, including "gene_id" and "North_20" with zeros
DGEs_Limma_north_20_25_30 <- data.frame(gene_id = rownames(selected_rows), North_20 = 0, North_25 = selected_rows$N20_N25, North_30 = selected_rows$N20_N30, adj.P.Val = selected_rows$adj.P.Val)

# Print the first few rows of filtered_rows_north
dim(DGEs_Limma_north_20_25_30) # 38  5

```

# limma - South 20 ºC vs 25 ºC vs 30 ºC

```{r}

# thresholds - south 20 vs 25 vs 30

top.table_south <- topTable(tmp_south_f, number=Inf, adjust="BH", sort.by="none")
FDR_south_df <- data.frame(gene_id = rownames(top.table_south), top.table_south)
# Filter the selected rows
selected_rows <- top.table_south[top.table_south$adj.P.Val < 0.05 & abs(top.table_south$S20_S25) > 1 & abs(top.table_south$S20_S30) > 1, ]

# Create a data frame with the desired columns, including "gene_id" and "North_20" with zeros
DGEs_Limma_south_20_25_30 <- data.frame(gene_id = rownames(selected_rows), South_20 = 0, South_25 = selected_rows$S20_S25, South_30 = selected_rows$S20_S30, adj.P.Val = selected_rows$adj.P.Val)

# Print the first few rows of filtered_rows_north
dim(DGEs_Limma_south_20_25_30)

```

# limma - North vs South

```{r}

# design matrix

design <- model.matrix(~sample_info$pop + sample_info$temperature)
rownames(design) <- colnames(y_filter)
y <- voom(y_filter, design, normalize="quantile")

# Fitting linear models in limma

fit <- lmFit(y, design)

tmp_all <- contrasts.fit(fit, coef=2)
tmp_all_f <- eBayes(tmp_all)

top.table_all <- topTable(tmp_all_f, number=Inf, adjust="BH", sort.by="none")
FDR_all_df <- data.frame(gene_id = rownames(top.table_all), top.table_all)

DGEs_Limma_North_South <- FDR_all_df[top.table_all$adj.P.Val < 0.05 & abs(top.table_all$logFC ) > 1, ]

dim(DGEs_Limma_North_South)  #   [1] 3030    7

```

# DESeq2

```{r}

# DESeq2 analysis

dds <- DESeqDataSetFromMatrix(y_filter$counts, colData = sample_info, design = formula(~group))

dds <- DESeq(dds, test="Wald")

results_names <- resultsNames(dds)
results_names   

############ Contrasts - South vs North Population ############

results_North_South_20 <- results(dds, contrast=c("group", "S.20", "N.20"))
results_North_South_25 <- results(dds, contrast=c("group", "S.25", "N.25"))
results_North_South_30 <- results(dds, contrast=c("group", "S.30", "N.30"))

############ Contrasts - North ############

results_25_20_north <- results(dds, contrast=c("group", "N.25", "N.20"))
results_30_20_north <- results(dds, contrast=c("group", "N.30", "N.20"))

############ Contrasts - South ############

results_25_20_south <- results(dds, contrast=c("group", "S.25", "S.20"))
results_30_20_south <- results(dds, contrast=c("group", "S.30", "S.20"))


```

# Dispersion Plot - DESeq2

```{r}

plotDispEsts(dds)

```

# DESeq2 - North 20 ºC vs South 20 ºC

```{r}

results_North_South_20 <- na.omit(results_North_South_20)
filter_results_N_S_20 <- results_North_South_20[results_North_South_20$padj < 0.05  & abs(results_North_South_20$log2FoldChange) > 1 ,]

filter_results_N_S_20 <- cbind(gene_id = rownames(filter_results_N_S_20), filter_results_N_S_20)
DGEs_DESeq2_north_south_20 <- filter_results_N_S_20[, c("gene_id", "log2FoldChange", "padj")]

dim(DGEs_DESeq2_north_south_20)   # [1] 1115   6

```

# DESeq2 - North 25 ºC vs South 25 ºC

```{r}

results_North_South_25 <- na.omit(results_North_South_25)
filter_results_N_S_25 <- results_North_South_25[results_North_South_25$padj < 0.05  & abs(results_North_South_25$log2FoldChange) > 1 ,]

filter_results_N_S_25 <- cbind(gene_id = rownames(filter_results_N_S_25), filter_results_N_S_25)
DGEs_DESeq2_north_south_25 <- filter_results_N_S_25[, c("gene_id", "log2FoldChange", "padj")]

dim(DGEs_DESeq2_north_south_25)   # [1] 1912    3

```

# DESeq2 - North 30 ºC vs South 30 ºC

```{r}

results_North_South_30 <- na.omit(results_North_South_30)
filter_results_N_S_30 <- results_North_South_30[results_North_South_30$padj < 0.05  & abs(results_North_South_30$log2FoldChange) > 1 ,]

filter_results_N_S_30 <- cbind(gene_id = rownames(filter_results_N_S_30), filter_results_N_S_30)
DGEs_DESeq2_north_south_30 <- filter_results_N_S_30[, c("gene_id", "log2FoldChange", "padj")]

dim(DGEs_DESeq2_north_south_30)   # [1] 3259   3

```

# DESeq2 - South 20 ºC 25 ºC

```{r}

results_25_20_south <- na.omit(results_25_20_south)
filter_results_S_25_20 <- results_25_20_south[results_25_20_south$padj < 0.05  & abs(results_25_20_south$log2FoldChange) > 1 ,]

filter_results_S_25_20 <- cbind(gene_id = rownames(filter_results_S_25_20), filter_results_S_25_20)
DGEs_DESeq2_south_25_20 <- filter_results_S_25_20[, c("gene_id", "log2FoldChange", "padj")]

dim(DGEs_DESeq2_south_25_20)

```
# DESeq2 - South 20 ºC 30 ºC

```{r}

results_30_20_south <- na.omit(results_30_20_south)
filter_results_S_20_30 <- results_30_20_south[results_30_20_south$padj < 0.05  & abs(results_30_20_south$log2FoldChange) > 1 ,]

filter_results_S_20_30 <- cbind(gene_id = rownames(filter_results_S_20_30), filter_results_S_20_30)
DGEs_DESeq2_south_20_30 <- filter_results_S_20_30[, c("gene_id", "log2FoldChange", "padj")]

dim(DGEs_DESeq2_south_20_30)

```



# DESeq2 - South 20 ºC vs 25 ºC vs 30 ºC

```{r}

gene_id_30_20 <- DGEs_DESeq2_south_20_30[, "gene_id", drop = FALSE] 

gene_id_25_20 <- DGEs_DESeq2_south_25_20[, "gene_id", drop = FALSE]

colnames(gene_id_25_20) <- "gene_id"
colnames(gene_id_30_20) <- "gene_id"

resulting_dataframe <- rbind(gene_id_25_20, gene_id_30_20)

resulting_dataframe <- unique(resulting_dataframe)

resulting_dataframe$log2FC_25 <- DGEs_DESeq2_south_25_20$log2FoldChange[match(resulting_dataframe$gene_id, DGEs_DESeq2_south_25_20$gene_id)]

resulting_dataframe$log2FC_30 <- DGEs_DESeq2_south_20_30$log2FoldChange[match(resulting_dataframe$gene_id, DGEs_DESeq2_south_20_30$gene_id)]

DGEs_DESeq2_south_20_25_30 <- na.omit(resulting_dataframe)
DGEs_DESeq2_south_20_25_30

```
# DESeq2 - North 20 ºC 25 ºC

```{r}

results_25_20_north <- na.omit(results_25_20_north)
filter_results_N_25_20 <- results_25_20_north[results_25_20_north$padj < 0.05  & abs(results_25_20_north$log2FoldChange) > 1 ,]

filter_results_N_25_20 <- cbind(gene_id = rownames(filter_results_N_25_20), filter_results_N_25_20)
DGEs_DESeq2_north_25_20 <- filter_results_N_25_20[, c("gene_id", "log2FoldChange", "padj")]

dim(DGEs_DESeq2_north_25_20)

```

# DESeq2 - North 20 ºC 30 ºC

```{r}

results_30_20_north <- na.omit(results_30_20_north)
filter_results_N_20_30 <- results_30_20_north[results_30_20_north$padj < 0.05  & abs(results_30_20_north$log2FoldChange) > 1 ,]

filter_results_N_20_30 <- cbind(gene_id = rownames(filter_results_N_20_30), filter_results_N_20_30)
DGEs_DESeq2_north_20_30 <- filter_results_N_20_30[, c("gene_id", "log2FoldChange", "padj")]

dim(DGEs_DESeq2_north_20_30)  


```

# DESeq2 - North 20 ºC vs 25 ºC vs 30 ºC

```{r}

gene_id_30_20 <- DGEs_DESeq2_north_20_30[, "gene_id", drop = FALSE] 

gene_id_25_20 <- DGEs_DESeq2_north_25_20[, "gene_id", drop = FALSE]

colnames(gene_id_25_20) <- "gene_id"
colnames(gene_id_30_20) <- "gene_id"

resulting_dataframe <- rbind(gene_id_25_20, gene_id_30_20)

resulting_dataframe <- unique(resulting_dataframe)

resulting_dataframe$log2FC_25 <- DGEs_DESeq2_north_25_20$log2FoldChange[match(resulting_dataframe$gene_id, DGEs_DESeq2_north_25_20$gene_id)]

resulting_dataframe$log2FC_30 <- DGEs_DESeq2_north_20_30$log2FoldChange[match(resulting_dataframe$gene_id, DGEs_DESeq2_north_20_30$gene_id)]

DGEs_DESeq2_north_20_25_30 <- na.omit(resulting_dataframe)
DGEs_DESeq2_north_20_25_30


```

# DESeq2 - North vs South

```{r}

dds <- DESeqDataSetFromMatrix(y_filter$counts, colData = sample_info, design = formula(~pop + temperature))

dds <- DESeq(dds, test="Wald")

results_all <- results(dds, contrast=c("pop", "S", "N"))

results_all <- na.omit(results_all)
filter_results_all <- results_all[results_all$padj < 0.05  & abs(results_all$log2FoldChange) > 1 ,]

filter_results_all <- cbind(gene_id = rownames(filter_results_all), filter_results_all)
DGEs_DESeq2_North_South <- filter_results_all[, c("gene_id", "log2FoldChange", "padj")]


dim(DGEs_DESeq2_North_South)   # [1]   3095    6


```

# Overlap 3 methods - North vs South 20 ºC

```{r}

DESeq2 <- DGEs_DESeq2_north_south_20$gene_id
EdgeR <- DGEs_EdgeR_north_south_20$gene_id
Limma <- DGEs_Limma_north_south_20$gene_id

common_rows <- DESeq2[DESeq2 %in% EdgeR & DESeq2 %in% Limma]

common_rows_list <- unlist(common_rows)

overlap_3_methods <- data.frame(gene_id = common_rows_list)

limma_data <- DGEs_Limma_north_south_20[, c("logFC", "adj.P.Val")]

limma_data$gene_id <- rownames(limma_data)

North_South_overlap_20 <- merge(overlap_3_methods, limma_data, by = "gene_id", all.x = TRUE)

head(North_South_overlap_20)
dim(North_South_overlap_20)
write.table(North_South_overlap_20, file = "North_South_overlap_20.txt", sep = "\t", quote = FALSE, row.names = FALSE)

```

```{r}

output_data_20 <- cpm_count_filtered_final[, grepl("^N20|^S20", colnames(cpm_count_filtered_final))]

# Add the 'gene_id' column to the output_data matrix
data_gene_id_20 <- cbind(gene_id = rownames(output_data_20), output_data_20)

# Add the name of the first column: gene_id
names(data_gene_id_20) <- c("gene_id", names(data_gene_id_20)[-1])

# merge the data frames based on the "gene_id" column
merged_df_20 <- merge(data_gene_id_20, North_South_overlap_20[, c("gene_id", "logFC", "adj.P.Val")], by = "gene_id")

# Selecting the desired columns
final_table_20 <- merged_df_20[, c("gene_id", "N20G1", "N20G2", "N20G3", "N20G5", "S20G1", "S20G2", "S20G3", "S20G4", "S20G5")]

# Convert character matrix to numeric matrix element-wise
numeric_matrix_20 <- final_table_20[, c("N20G1", "N20G2", "N20G3", "N20G5", "S20G1", "S20G2", "S20G3", "S20G4", "S20G5")]
numeric_matrix_20 <- apply(numeric_matrix_20, 2, as.numeric)  # Convert each column to numeric

# Set row names
rownames(numeric_matrix_20) <- final_table_20$gene_id

# Set column names
colnames(numeric_matrix_20) <- c("N20G1", "N20G2", "N20G3", "N20G5", "S20G1", "S20G2", "S20G3", "S20G4", "S20G5")

head(numeric_matrix_20)
dim(numeric_matrix_20)

```

```{r}

gene_labels <- rownames(numeric_matrix_20)
condition_labels <- colnames(numeric_matrix_20)

heatmap.2(numeric_matrix_20,
          scale = "row",
          trace = "none",                   
          col = colorRampPalette(colors = c("#273D82", "white", "#C75218"))(100),
          main = "North vs South 20ºC",
          cex.main = 1,
          Colv = TRUE,                      
          hclustfun = function(c) hclust(c, method = "average"),   
          dendrogram = "column",           
          key = TRUE,
          key.title = " ", 
          key.xlab = "Row Z-Score",    
          margins = c(5, 15),
          cexRow = 0.8,   
          cexCol = 0.8,
          Rowv = TRUE,    
          labRow = FALSE 
)



```

# Data for volcano plots

```{r}

colnames(North_South_overlap_20) <- c("gene_id", "logFC", "adj.P.Val")

# Add a column to the data frame to specify if they are UP- or DOWN- regulated 
North_South_overlap_20$diffexpressed <- "NO"

# if log2Foldchange > 0.6 and pvalue < 0.05, set as "Up regulated"
North_South_overlap_20$diffexpressed[North_South_overlap_20$logFC > 0.6 & North_South_overlap_20$adj.P.Val < 0.05] <- "Up regulated"

# if log2Foldchange < -0.6 and pvalue < 0.05, set as "Down regulated"
North_South_overlap_20$diffexpressed[North_South_overlap_20$logFC < -0.6 & North_South_overlap_20$adj.P.Val < 0.05] <- "Down regulated"

# number of DGEs - up and down regulated
up_regulated_count <- sum(North_South_overlap_20$diffexpressed == "Up regulated")
down_regulated_count <- sum(North_South_overlap_20$diffexpressed == "Down regulated")
cat("Number of up-regulated genes:", up_regulated_count, "\n")
cat("Number of down-regulated genes:", down_regulated_count, "\n")

```

```{r}

ggplot(data = North_South_overlap_20, aes(x = logFC, y = -log10(adj.P.Val), col = diffexpressed)) +
  geom_vline(xintercept = c(-0.6, 0.6), col = "gray20", linetype = 'dashed') +
  geom_hline(yintercept = -log10(0.05), col = "gray20", linetype = 'dashed') +
  geom_point(size = 2) +
  scale_color_manual(values = c("#00AFBB", "#bb0c00"), 
                     labels = c("Downregulated", "Upregulated")) +
  xlab(expression(log[2]~Fold~Change)) +
  ylab(expression(-log[10]~padj)) +
  theme_bw() +
  theme(
    axis.line = element_line(color = "black", size = 0.5),  # Customize axis lines
    panel.border = element_blank(),  # Remove plot border
    axis.title = element_text(size = 17),  # Set axis title font size
    legend.title = element_text(size = 14),  # Set legend title font size
    legend.position = "right"  # Move the legend to the right
  ) +
  guides(
    color = guide_legend(title = "Expression Level")  # Customize legend title
  )

```

# Overlap 3 methods - North vs South 25 ºC

```{r}

DESeq2 <- DGEs_DESeq2_north_south_25$gene_id
EdgeR <- DGEs_EdgeR_north_south_25$gene_id
Limma <- DGEs_Limma_north_south_25$gene_id

common_rows <- DESeq2[DESeq2 %in% EdgeR & DESeq2 %in% Limma]

common_rows_list <- unlist(common_rows)

overlap_3_methods <- data.frame(gene_id = common_rows_list)

dim(overlap_3_methods)

limma_data <- DGEs_Limma_north_south_25[, c("logFC", "adj.P.Val")]

limma_data$gene_id <- rownames(limma_data)

North_South_overlap_25 <- merge(overlap_3_methods, limma_data, by = "gene_id", all.x = TRUE)

head(North_South_overlap_25)
dim(North_South_overlap_25)
write.table(North_South_overlap_25, file = "North_South_overlap_25.txt", sep = "\t", quote = FALSE, row.names = FALSE)

```

```{r}

output_data_25 <- cpm_count_filtered_final[, grepl("^N25|^S25", colnames(cpm_count_filtered_final))]

# Add the 'gene_id' column to the output_data matrix
data_gene_id_25 <- cbind(gene_id = rownames(output_data_25), output_data_25)

# Add the name of the first column: gene_id
names(data_gene_id_25) <- c("gene_id", names(data_gene_id_25)[-1])

# merge the data frames based on the "gene_id" column
merged_df_25 <- merge(data_gene_id_25, North_South_overlap_25[, c("gene_id", "logFC", "adj.P.Val")], by = "gene_id")

# Selecting the desired columns
final_table_25 <- merged_df_25[, c("gene_id", "N25G1", "N25G2", "N25G3", "N25G4", "N25G5", "S25G1", "S25G2", "S25G3", "S25G4", "S25G5")]

# Convert character matrix to numeric matrix element-wise
numeric_matrix_25 <- final_table_25[, c( "N25G1", "N25G2", "N25G3", "N25G4", "N25G5", "S25G1", "S25G2", "S25G3", "S25G4", "S25G5")]
numeric_matrix_25 <- apply(numeric_matrix_25, 2, as.numeric)  # Convert each column to numeric

# Set row names
rownames(numeric_matrix_25) <- final_table_25$gene_id

# Set column names
colnames(numeric_matrix_25) <- c("N25G1", "N25G2", "N25G3", "N25G4", "N25G5", "S25G1", "S25G2", "S25G3", "S25G4", "S25G5")

head(numeric_matrix_25)
dim(numeric_matrix_25)

```

# Heatmap 

```{r}

gene_labels <- rownames(numeric_matrix_25)
condition_labels <- colnames(numeric_matrix_25)

heatmap.2(numeric_matrix_25,
          scale = "row",
          trace = "none",                   
          col = colorRampPalette(colors = c("#273D82", "white", "#C75218"))(100),
          main = "North vs South 25ºC",
          cex.main = 1,
          Colv = TRUE,                      
          hclustfun = function(c) hclust(c, method = "average"),   
          dendrogram = "column",           
          key = TRUE,
          key.title = " ", 
          key.xlab = "Row Z-Score",    
          margins = c(5, 15),
          cexRow = 0.8,   
          cexCol = 0.8,
          Rowv = TRUE,    
          labRow = FALSE 
)



```

# Data for volcano plot

```{r}

colnames(North_South_overlap_25) <- c("gene_id", "logFC", "adj.P.Val")

North_South_overlap_25$diffexpressed <- "NO"

North_South_overlap_25$diffexpressed[North_South_overlap_25$logFC > 0.6 & North_South_overlap_25$adj.P.Val < 0.05] <- "Up regulated"

North_South_overlap_25$diffexpressed[North_South_overlap_25$logFC < -0.6 & North_South_overlap_25$adj.P.Val < 0.05] <- "Down regulated"


# number of DGEs - up and down regulated
up_regulated_count <- sum(North_South_overlap_25$diffexpressed == "Up regulated")
down_regulated_count <- sum(North_South_overlap_25$diffexpressed == "Down regulated")
cat("Number of up-regulated genes:", up_regulated_count, "\n")
cat("Number of down-regulated genes:", down_regulated_count, "\n")


```

```{r}

ggplot(data = North_South_overlap_25, aes(x = logFC, y = -log10(adj.P.Val), col = diffexpressed)) +
  geom_vline(xintercept = c(-0.6, 0.6), col = "gray20", linetype = 'dashed') +
  geom_hline(yintercept = -log10(0.05), col = "gray20", linetype = 'dashed') +
  geom_point(size = 2) +
  scale_color_manual(values = c("#00AFBB", "#bb0c00"), 
                     labels = c("Downregulated", "Upregulated")) +
  xlab(expression(log[2]~Fold~Change)) +
  ylab(expression(-log[10]~padj)) +
  theme_bw() +
  theme(
    axis.line = element_line(color = "black", size = 0.5),  # Customize axis lines
    panel.border = element_blank(),  # Remove plot border
    axis.title = element_text(size = 17),  # Set axis title font size
    legend.title = element_text(size = 14),  # Set legend title font size
    legend.position = "right"  # Move the legend to the right
  ) +
  guides(
    color = guide_legend(title = "Expression Level")  # Customize legend title
  )



```

# Overlap 3 methods - North vs South 30 ºC

```{r}

DESeq2 <- DGEs_DESeq2_north_south_30$gene_id
EdgeR <- DGEs_EdgeR_north_south_30$gene_id
Limma <- DGEs_Limma_north_south_30$gene_id

common_rows <- DESeq2[DESeq2 %in% EdgeR & DESeq2 %in% Limma]

common_rows_list <- unlist(common_rows)

overlap_3_methods <- data.frame(gene_id = common_rows_list)

dim(overlap_3_methods)

limma_data <- DGEs_Limma_north_south_30[, c("logFC", "adj.P.Val")]

limma_data$gene_id <- rownames(limma_data)

North_South_overlap_30 <- merge(overlap_3_methods, limma_data, by = "gene_id", all.x = TRUE)

head(North_South_overlap_30)
dim(North_South_overlap_30)
write.table(North_South_overlap_30, file = "North_South_overlap_30.txt", sep = "\t", quote = FALSE, row.names = FALSE)

```

```{r}

output_data_30 <- cpm_count_filtered_final[, grepl("^N30|^S30", colnames(cpm_count_filtered_final))]

# Add the 'gene_id' column to the output_data matrix
data_gene_id_30 <- cbind(gene_id = rownames(output_data_30), output_data_30)

# Add the name of the first column: gene_id
names(data_gene_id_30) <- c("gene_id", names(data_gene_id_30)[-1])

# merge the data frames based on the "gene_id" column
merged_df_30 <- merge(data_gene_id_30, North_South_overlap_30[, c("gene_id", "logFC", "adj.P.Val")], by = "gene_id")

# Selecting the desired columns
final_table_30 <- merged_df_30[, c("gene_id", "N30G1", "N30G2", "N30G3", "N30G4", "N30G5", "S30G1", "S30G2", "S30G3", "S30G4", "S30G5")]

# Convert character matrix to numeric matrix element-wise
numeric_matrix_30 <- final_table_30[, c( "N30G1", "N30G2", "N30G3", "N30G4", "N30G5", "S30G1", "S30G2", "S30G3", "S30G4", "S30G5")]
numeric_matrix_30 <- apply(numeric_matrix_30, 2, as.numeric)  # Convert each column to numeric

# Set row names
rownames(numeric_matrix_30) <- final_table_30$gene_id

# Set column names
colnames(numeric_matrix_30) <- c("N30G1", "N30G2", "N30G3", "N30G4", "N30G5", "S30G1", "S30G2", "S30G3", "S30G4", "S30G5")

head(numeric_matrix_30)
dim(numeric_matrix_30)

```

# Heatmap

```{r}

library(gplots)

gene_labels <- rownames(numeric_matrix_30)
condition_labels <- colnames(numeric_matrix_30)

heatmap.2(numeric_matrix_30,
          scale = "row",
          trace = "none",                   
          col = colorRampPalette(colors = c("#273D82", "white", "#C75218"))(100),
          main = "North vs South 30ºC",
          cex.main = 1,
          Colv = TRUE,                      
          hclustfun = function(c) hclust(c, method = "average"),   
          dendrogram = "column",           
          key = TRUE,
          key.title = " ", 
          key.xlab = "Row Z-Score",    
          margins = c(5, 15),
          cexRow = 0.8,   
          cexCol = 0.8,
          Rowv = TRUE,    
          labRow = FALSE 
)

```

# Data for volcano plot

```{r}

colnames(North_South_overlap_30) <- c("gene_id", "logFC", "adj.P.Val")

North_South_overlap_30$diffexpressed <- "NO"

North_South_overlap_30$diffexpressed[North_South_overlap_30$logFC > 0.6 & North_South_overlap_30$adj.P.Val < 0.05] <- "Up regulated"

North_South_overlap_30$diffexpressed[North_South_overlap_30$logFC < -0.6 & North_South_overlap_30$adj.P.Val < 0.05] <- "Down regulated"


# number of DGEs - up and down regulated
up_regulated_count <- sum(North_South_overlap_30$diffexpressed == "Up regulated")
down_regulated_count <- sum(North_South_overlap_30$diffexpressed == "Down regulated")
cat("Number of up-regulated genes:", up_regulated_count, "\n")
cat("Number of down-regulated genes:", down_regulated_count, "\n")


```

```{r}

ggplot(data = North_South_overlap_30, aes(x = logFC, y = -log10(adj.P.Val), col = diffexpressed)) +
  geom_vline(xintercept = c(-0.6, 0.6), col = "gray20", linetype = 'dashed') +
  geom_hline(yintercept = -log10(0.05), col = "gray20", linetype = 'dashed') +
  geom_point(size = 2) +
  scale_color_manual(values = c("#00AFBB", "#bb0c00"), 
                     labels = c("Downregulated", "Upregulated")) +
  xlab(expression(log[2]~Fold~Change)) +
  ylab(expression(-log[10]~padj)) +
  theme_bw() +
  theme(
    axis.line = element_line(color = "black", size = 0.5),  # Customize axis lines
    panel.border = element_blank(),  # Remove plot border
    axis.title = element_text(size = 17),  # Set axis title font size
    legend.title = element_text(size = 14),  # Set legend title font size
    legend.position = "right"  # Move the legend to the right
  ) +
  guides(
    color = guide_legend(title = "Expression Level")  # Customize legend title
  )


```

# Overlap 3 methods - North vs South

```{r}

DESeq2 <- DGEs_DESeq2_North_South$gene_id
EdgeR <- DGEs_EdgeR_North_South$gene_id
Limma <- DGEs_Limma_North_South$gene_id

common_rows <- DESeq2[DESeq2 %in% EdgeR & DESeq2 %in% Limma]

common_rows_list <- unlist(common_rows)

overlap_3_methods <- data.frame(gene_id = common_rows_list)


limma_data <- DGEs_Limma_North_South[, c("logFC", "adj.P.Val")]

limma_data$gene_id <- rownames(limma_data)


North_South_overlap <- merge(overlap_3_methods, limma_data, by = "gene_id", all.x = TRUE)

#head(North_South_overlap)

dim(North_South_overlap)

write.table(North_South_overlap, file = "North_South_overlap.txt", sep = "\t", quote = FALSE, row.names = FALSE)

```

```{r}

output_data_chronic_all <- cpm_count_filtered_final[, grepl("^N|^S", colnames(cpm_count_filtered_final))]

# Add the 'gene_id' column to the output_data matrix
data_gene_id_chronic_all <- cbind(gene_id = rownames(output_data_chronic_all), output_data_chronic_all)

# Add the name of the first column: gene_id
names(data_gene_id_chronic_all) <- c("gene_id", names(data_gene_id_chronic_all)[-1])

# merge the data frames based on the "gene_id" column
merged_df_chronic_all <- merge(data_gene_id_chronic_all, North_South_overlap[, c("gene_id", "logFC", "adj.P.Val")], by = "gene_id")

# Selecting the desired columns
final_table_chronic_all <- merged_df_chronic_all[, c("gene_id", "N20G1", "N20G2", "N20G3", "N20G5", "S20G1", "S20G2", "S20G3", "S20G4", "S20G5", "N25G1", "N25G2", "N25G3", "N25G4", "N25G5", "S25G1", "S25G2", "S25G3", "S25G4", "S25G5", "N30G1", "N30G2", "N30G3", "N30G4", "N30G5", "S30G1", "S30G2", "S30G3", "S30G4", "S30G5")]

# Convert character matrix to numeric matrix element-wise
North_South_all_overlap <- final_table_chronic_all[, c( "N20G1", "N20G2", "N20G3", "N20G5", "S20G1", "S20G2", "S20G3", "S20G4", "S20G5", "N25G1", "N25G2", "N25G3", "N25G4", "N25G5", "S25G1", "S25G2", "S25G3", "S25G4", "S25G5", "N30G1", "N30G2", "N30G3", "N30G4", "N30G5", "S30G1", "S30G2", "S30G3", "S30G4", "S30G5")]
North_South_all_overlap <- apply(North_South_all_overlap, 2, as.numeric)

# Set row names
rownames(North_South_all_overlap) <- final_table_chronic_all$gene_id

# Set column names
colnames(North_South_all_overlap) <- c("N20G1", "N20G2", "N20G3", "N20G5", "S20G1", "S20G2", "S20G3", "S20G4", "S20G5", "N25G1", "N25G2", "N25G3", "N25G4", "N25G5", "S25G1", "S25G2", "S25G3", "S25G4", "S25G5", "N30G1", "N30G2", "N30G3", "N30G4", "N30G5", "S30G1", "S30G2", "S30G3", "S30G4", "S30G5")

dim(North_South_all_overlap)

```

```{r}


library(gplots)

gene_labels <- rownames(North_South_all_overlap)
condition_labels <- colnames(North_South_all_overlap)

heatmap.2(North_South_all_overlap,
          scale = "row",
          trace = "none",                   
          col = colorRampPalette(colors = c("#273D82", "white", "#C75218"))(100),
          main = "North vs South",
          cex.main = 1,
          Colv = TRUE,                      
          hclustfun = function(c) hclust(c, method = "average"),   
          dendrogram = "column",           
          key = TRUE,
          key.title = " ", 
          key.xlab = "Row Z-Score",    
          margins = c(5, 15),
          cexRow = 0.8,   
          cexCol = 0.8,
          Rowv = TRUE,    
          labRow = FALSE 
)



```

# Data for volcano plot

```{r}

colnames(North_South_overlap) <- c("gene_id", "logFC", "adj.P.Val")

North_South_overlap$diffexpressed <- "NO"

North_South_overlap$diffexpressed[North_South_overlap$logFC > 0.6 & North_South_overlap$adj.P.Val < 0.05] <- "Up regulated"

North_South_overlap$diffexpressed[North_South_overlap$logFC < -0.6 & North_South_overlap$adj.P.Val < 0.05] <- "Down regulated"


# number of DGEs - up and down regulated
up_regulated_count <- sum(North_South_overlap$diffexpressed == "Up regulated")
down_regulated_count <- sum(North_South_overlap$diffexpressed == "Down regulated")
cat("Number of up-regulated genes:", up_regulated_count, "\n")
cat("Number of down-regulated genes:", down_regulated_count, "\n")


```

# Volcano Plot

```{r}

ggplot(data = North_South_overlap, aes(x = logFC, y = -log10(adj.P.Val), col = diffexpressed)) +
  geom_vline(xintercept = c(-0.6, 0.6), col = "gray20", linetype = 'dashed') +
  geom_hline(yintercept = -log10(0.05), col = "gray20", linetype = 'dashed') +
  geom_point(size = 2) +
  scale_color_manual(values = c("#00AFBB", "#bb0c00"), 
                     labels = c("Downregulated", "Upregulated")) +
  xlab(expression(log[2]~Fold~Change)) +
  ylab(expression(-log[10]~padj)) +
  theme_bw() +
  theme(
    axis.line = element_line(color = "black", size = 0.5),  # Customize axis lines
    panel.border = element_blank(),  # Remove plot border
    axis.title = element_text(size = 17),  # Set axis title font size
    legend.title = element_text(size = 14),  # Set legend title font size
    legend.position = "right"  # Move the legend to the right
  ) +
  guides(
    color = guide_legend(title = "Expression Level")  # Customize legend title
  )
```

# Overlap 3 methods - South 20 ºC vs 25 ºC vs 30 ºC

```{r}

library(ggvenn)

DESeq2 <- DGEs_DESeq2_south_20_25_30$gene_id
EdgeR <- DGEs_EdgeR_south_20_25_30$gene_id
Limma <- DGEs_Limma_south_20_25_30$gene_id

# Create a list with each vector as an element
myList <- list(DESeq2 = DESeq2, EdgeR = EdgeR, Limma = Limma)

ggvenn(myList, fill_color = c("#FFCCCC","#FF6666","#CC0000"))


```

# Overlap 3 methods - North 20 ºC vs 25 ºC vs 30 ºC

```{r}

library(ggvenn)  

DESeq2 <- DGEs_DESeq2_north_20_25_30$gene_id
EdgeR <- DGEs_EdgeR_north_20_25_30$gene_id
Limma <- DGEs_Limma_north_20_25_30$gene_id

# Create a list with each vector as an element
myList <- list(DESeq2 = DESeq2, EdgeR = EdgeR, Limma = Limma)

# Create a Venn diagram
ggvenn(myList, fill_color=c("#AED6F1","#5499C7","#1f618d"))

```
